.. sectionauthor:: Роман Гайнуллов <roman.gainullov@nextgis.ru>

.. role:: underline
    :class: underline

Сбор геоданных на своем сервере
============================

.. _intro:

Введение
--------

.. note:: 
	**Условие**: Данное руководство предполагает наличие у пользователя приобретенной лицензии NextGIS Web для своего сервера в редакции `Extended <https://nextgis.ru/pricing/#ngwextended>`_.

**Программное обеспечение и компоненты:**

* `NextGIS Formbuilder <https://nextgis.ru/nextgis-formbuilder>`_ - настольное приложение для создания форм при подготовке к сбору геоданных.
* `NextGIS Collector <https://nextgis.ru/nextgis-collector/>`_ - специализированное мобильное приложение для сбора геоданных в полевых условиях.
* `NextGIS Web <https://nextgis.ru/nextgis-web/>`_ (NGW) - серверная Веб ГИС для синхронизации полученных в полевых условиях пространственных данных, их дальнейшего хранения, обработки, визуализации и анализа.
* `NextGIS ID on-premise <https://docs.nextgis.ru/docs_ngid/source/toc.html>`_ (NGIDOP) - сервер авторизации пользователей для управления доступом к процессу сбора геоданных.

**Роли (пользователи)**: Администратор и Сборщики данных. **Администратор** отвечает за настройку процесса сбора (:underline:`Formbuilder, NGW`). **Сборщики данных** используют только приложение :underline:`NextGIS Collector`.

**Состав данных:** Геоданные состоят из двух компонентов - географической (координаты точек) и атрибутивной (описание, вложения/фото) информации.


.. _admin_checklist:

Чек-лист Администратора
-----------------------

1. Развернуты NGW и NGIDOP на своем сервере. Есть логин и пароль администратора
2. Убедиться в наличии настроек NGIDOP (разделы `Приложения OAuth <https://docs.nextgis.ru/docs_ngid/source/ngidop.html#oauth>`_ и `NextGIS ID on-premise <https://docs.nextgis.ru/docs_ngid/source/ngidop.html#nextgis-id-on-premise>`_ - настройки collector_hub в соответствии с адресом, где он был развернут) - **без этого сбор данных будет невозможен**. Параметры конфигурации предоставляются по запросу
3. Завести пользователей для сборщиков данных в Разделе `Команда <https://docs.nextgis.ru/docs_ngid/source/ngidop.html#ngidop-teams>`_ NGIDOP
4. Далее перейти в NextGIS Web. Через `Панель управления <https://docs.nextgis.ru/docs_ngcom/source/collector.html#id11>`_ создать список участников сбора данных с именами пользователей, аналогичными пользователям в Команде на предыдущем шаге. В дальнейшем при настройке всех проектов сбора данных пользователи (сборщики) будут браться из этого списка
5. Создать точечные векторные слои в NextGIS Web, в которые данные будут собираться. Это можно сделать как из `интерфейса <https://docs.nextgis.ru/docs_ngweb/source/layers.html#ngw-create-vector-layer>`_, так и с помощью `NextGIS Formbuilder <https://nextgis.ru/nextgis-formbuilder>`_, создав специальную форму для сбора данных. Более подробный процесс создания форм описан в `документации <https://docs.nextgis.ru/docs_formbuilder/source/toc.html>`_. Заметим, что здесь нужно будет поменять `endpoint авторизации <https://docs.nextgis.ru/docs_formbuilder/source/gui.html#ngidop>`_ с облака (my.nextgis.com) на развернутый сервер авторизации NextGIS ID on-premise

—--------------------

Далее можно начинать настраивать конкретные проекты для дальнейшего сбора данных. Для этого в NGW существует специальный ресурс - **Проект Collector** (проект сбора данных). Потребуется указать название нового ресурса (его будут видеть сборщики данных в приложении NextGIS Collector и администратор в интерфейсе NGW), по желанию описание и метаданные.

6. Важными частями каждого проекта сбора данных являются вкладки **Проект, Элементы, Участники**. На вкладке **Проект** администратор указывает имя пользователя NGW, от лица которого будет производиться запись собранных данных в базу. По умолчанию это может быть *administrator*, полученный после установки NGW на сервере. Однако мы рекомендуем `создать <https://docs.nextgis.ru/docs_ngweb/source/admin_tasks.html>`_ специального пользователя для этих целей. На вкладке **Элементы** нужно добавить слои, в которые данные будут собираться, и подложки для более комфортного процесса их сбора. На вкладке **Участники** из списка необходимо выбрать пользователей (сборщиков данных), которые будут иметь доступ к сбору данных в настраиваемом проекте (из п.4). Сохранить проект со всеми настройками.

—--------------------

7. Работа сборщиков в мобильном приложении `NextGIS Collector <https://docs.nextgis.ru/docs_collector/source/toc.html>`_. В первую очередь (аналогично Formbuilder) сборщик данных должен поменять `сервер авторизации <https://docs.nextgis.ru/docs_collector/source/auth.html#ngidop>`_ на NGIDOP. Далее работа происходит стандартная работа сборщика поле - авторизация под выданными администратором логином и паролем (из раздела Команда) и сбор данных. Основные моменты по работе с приложением описаны в `документации <https://docs.nextgis.ru/docs_collector/source/toc.html>`_.

—--------------------

Дополнительно можно ознакомиться с процессом сбора данных `для облака nextgis.com <https://docs.nextgis.ru/docs_ngcom/source/collector.html>`_.
