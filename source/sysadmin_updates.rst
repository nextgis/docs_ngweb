.. sectionauthor:: Максим Дубинин <maxim.dubinin@nextgis.com>

.. _sysadmin_updates:

Список изменений
================

**Релиз 4.6.0 от 27.12.2023 и 29.12.2023**

* Исправлена работа стилей для слоёв WFS.

**Релиз 4.6.0 от 27.12.2023 и 29.12.2023**

* Поддержка справочников в атрибутах слоёв объектов.
* К форматам печати PDF, JPEG, PNG добавлен TIFF.
* Фильтрация таблиц объектов по геометрии на веб-картах.
* Автоопределение масштабов отрисовки слоёв веб-карт и WMS.
* Обновление таблиц объектов после внесения изменений на веб-картах.
* Улучшена обработка атрибутов векторных слоёв ``id`` и ``fid``.
* Улучшен функционал полей даты и времени.
* Масштабирование веб-карты параметром ``zoom``.
* Поддержка запросов UserInfo для OpenID Connect.
* Извлечение масштабов отрисовки из стилей QML.
* Исправлена ошибка конфигурации NextGIS ID.
* Добавлена поддержка PostgreSQL 12.

**Релиз 4.5.1 от 17.11.2023**

* Исправление печати в формате TIFF в дополнение к PDF, JPEG и PNG.

**Релиз 4.5.0 от 29.09.2023**

* Набор тайлов - новый ресурс для хранения и раздачи подготовленных тайлов.
* Новый сервис OGC API Features с поддержкой чтения и записи объектов.
* 2-кратное ускорение загрузки данных векторных слоёв.
* Охват веб-карты разделён на начальный и ограничивающий.
* Поддержка метрик Яндекса и Google Analytics.
* Поддержка базовых пользовательских стилей.
* Экспорт в PDF из панели печати веб-карты.
* Проверка действующих разрешений других пользователей к ресурсу.
* Легенды веб-карт включены по умолчанию.
* Улучшения виджетов редактирования объектов.
* Объявление параметра OutputFormat в сервисе WFS для лучшей совместимости.
* Хранение журнала аудита в базе PostgreSQL вместо ElasticSearch.
* Обновлена библиотека React до версии 18.
* Обновлена библиотека Ant Design до версии 5.

**Релиз 4.4.0 от 30.06.2023**

* Автоматически конфигурируемые легенды для веб-карт.
* Изменения порядка слоёв перетаскиванием на веб-картах.
* Изменение прозрачности слоя при просмотре веб-карты.
* Создание пустого векторного слоя без загрузки файла.
* Возможность замены существующего векторного слоя, объектов и структуры из файла.
* Таблица атрибутов теперь на React.
* Редактор описаний объектов и ресурсов обновлен до CKEditor 5.
* Улучшенное управление описаниями ресурсов на веб-картах.
* Приближение к отфильтрованному набору объектов на веб-картах.
* Свойства геометрии в окне идентификации.
* Текущие координаты курсора и охват на веб-картах.
* Приближение ко всем слоям на веб-картах.
* Поддержка линейных и полигональных аннотаций.
* Имена ресурсов по умолчанию при их создании.
* Удаление всех объектов и изменение типа геометрии для векторных слоёв.
* Ограничение по охвату при экспорте векторного слоя.
* Экспорт отфильтрованного набора объектов.
* Поддержка форматов MapInfo при создании векторного слоя.
* Клиент TMS: параллельное получение тайлов и HTTP/2.
* Более здоровый порядок вкладок настроек ресурсов и авто-активация.
* Улучшенное дерево слоёв на веб-картах.
* Быстрое сжатие PNG при отрисовке.
* Требования по браузерам: Chrome 102+, Safari 15+, Edge 109+ или Firefox 102+.
* Пользовательские права на ресурс перемещены на отдельную страницу.
* Автоматическое назначение группы при входе через OAuth.

**Релиз 4.3.1 от 14.12.2022**

* Исправление выбора групп при клонировании веб-карт.

**Релиз 4.3.0 от 21.11.2022**

* Клонирование веб-карт в интерфейсе.
* Поиск по координатам на веб-карте.
* Создание векторных слоев из CSV и XLSX.
* Экспорт и импорт вложений объектов векторных слоев.
* Экспорт векторных слоев в форматы  KML и KMZ.
* Выбор полей при экспорте векторных слоев.
* Назначение групп по умолчанию при создании пользователей.
* Экспериментальная поддержка авторизационных ссылок.
* Использования СК слоя по умолчанию при экспорте слоев.
* Поддержка логических и NULL значений в метаданных ресурсов.
* Поддержка колонок character фиксированной длины в слоях PostGIS.
* Поддержка материализованных представлений и 25D геометрий в слоях PostGIS.
* Возможность отключать авторизацию по паролю оставляя только OAuth.
* Проверка свободного места в healthcheck.
* Возможность рекурсивного поиска ресурсов в REST API.
* Библиотека OpenLayers обновлена до 6.15.1.

**релиз 4.2.0 от 18.07.2022**

* Инструмент "Найти меня" на веб-картах.
* Настройка идентифицируемости слоя на веб-карте.
* Пакетное удаление и перемещение ресурсов.
* Возможность скачивания растровых слоёв во внутреннем представлении.
* Инструмент диагностики соединений и слоёв PostGIS.
* Поддержка подложек c quad-key на веб-картах.
* Улучшения OAuth: интеграция NextGIS ID, совместное использование authorization code и password grant.
* Улучшенное управление системами координат и интеграция с каталогом.
* Улучшенная поддержка 25D геометрий на веб-картах и в слоях PostGIS.
* Улучшенная обработка URL в описаниях и полях векторного слоя.
* Cloud-optimized GeoTIFF (COG) включено по умолчанию.
* Конвертация между COG и не COG растровыми слоями без перезагрузки.
* Сокрытие пустых групп и групп без доступных слоев на веб-карте.
* Автоматическое удалении измерения M при создании векторных слоёв.
* Выделение объектов на веб-карте при помощи URL параметров hl_*.
* Возможность вставки произвольного HTML в базовый шаблон для метрик и счетчиков.
* Быстрая сериализация и десериализация JSON на базе библиотеки orjson.
* Завершена миграция панели управления на Antd и React.

**Релиз 4.1.0 от 16.02.2022**

* Поддержка растровых слоёв в формате Cloud-optimized GeoTIFF (COG).
* Проверка совместимости браузера. Прекращена поддержка Internet Explorer.
* Экспериментальная поддержка долгих запросов при создании растровых и векторных слоёв через расширение lunkwill.
* Приватные аннотации на веб-картах, видимые только авторам.
* Переход через линию перемены даты для тайловых слоёв на веб-картах.
* Множество улучшений контрольной панели: фильтры, групповые операции и прочее.
* Обработка исходных векторных слоёв с полями id и geom.
* Перепроецирование в другие системы координат в сервисах WMS и WFS.
* Экспорт слоя объектов используя наименования атрибутов вместо ключей.
* Поддержка CORS доменов с подстановкой (например: https://*.csb.app).
* Поддержка простых фильтров для клиента и сервера WFS.
* Улучшена обработка координат, выходящих за пределы системы координат.
* Поддержка геометрий 25D для слоёв PostGIS.
* Фильтр по значению NULL в REST API объектов.
* Фильтр по неизвестным полям в REST API теперь выдаёт ошибку.
* Улучшена обработка ошибок и установлены таймауты для запросов к сторонным сервисам.
* Обновлены зависимости: Pyramid 2.0, SQLAlchemy 1.4 и OpenLayers 6.10.

**Релиз 4.0.0 от 18.11.2021**

* Выбор слоя при создании векторного слоя из источника с несколькими слоями, таких как архивы ZIP или Mapinfo TAB.
* Перепроецирование на лету для сервисов WMS и WFS.
* Возможность ограничить адресный поиск страной в поисковике Nominatim.
* В списке слоёв веб-карты не показываются недоступные слои.
* Подсветка объектов при выделении объекта из резульата поиска.
* Display emails as active mailto: links in the webmap popup.
* Отображение адресов электронной почты в виде ссылок "mailto:" в карточке объекта веб-карты.
* Возможность удаления пользователей и групп в панели управления.
* Возможность изменять владельца ресурса.
* Автоматическая генерация ключей слоёв сервисов WMS и WFS.
* Улучшена поддержка Unicode для атрибутов слоёв WFS.
* Настройка доступности экспорта ресурсов в панели управления.
* В REST API объектов можно передавать дату в формате ISO-8601 с параметром dt_format=iso.
* Прекращена поддержка Python 2.7. Теперь в NextGIS Web требуется Python 3.8+.
* Требуются версии PostgreSQL 10+, PostGIS 2.5+ и GDAL 3.0+.
* Синхронизация переводов с POEditor.
* Возможность поиска Яндекс-карт на веб-карте.

**Релиз 3.9.0 от 11.08.2021**

* Добавлена функция предпросмотра слоя на отдельной карте.
* Добавлена панель поиска ресурсов.
* В панели управления добавлена настройка выключения адресного поиска и ограничения по охвату карты.
* Уточнен охват результатов адресного поиска и закладок.
* Добавлены автоопределение языка, настройка языка для пользователя и поддержка внешних файлов переводов.
* Автоматическое понижение разрешения изображения для предпросмотра в соцсетях до 1600x630 пикс.
* Улучшена поддержка KML: используется драйвер LIBKML, если он доступен в GDAL.
* Фильтрация объектов по ID в REST API.
* Слои с полем "id" теперь можно загрузить, если поле типа int32.
* Добавлена информация о доступных обновлениях в панели управления.
* Экспериментальный подсчёт занимаемого места и подсистема оценки хранилища.

**Релиз 3.8.0 от 12.05.2021**

* Добавлена возможность ограничить вебкарту охватом по умолчанию.
* Расширен выбор единиц измерений в настройках вебкарты.
* Добавлена возможность автоматической коррекции ошибок при загрузке векторного слоя.
* Поддержка создания векторного слоя из файлов GML и KML.
* Логин пользователя теперь нечувствителен к регистру.
* Добавлена настройка для выключения панели соцсетей вебкарты.
* Улучшена производительность при получении и отрисовке геометрий, особенно при конвертации между форматами WKT и WKB.
* Улучшена производительность тайлового кэша.
* Улучшен перенос слов в окне идентификации вебкарты.
* Реализована поддержка максимального и минимального масштаба слоёв сервиса WMS.
* Экспериментальная интеграция современного JavaScript и Webpack.
* Библиотека OpenLayers обновлена до версии 6.5.0.  
* Добавлена настройка выхода из учётной записи OAuth.

**Релиз 3.7.0**

* Добавлен фреймворк миграция баз данных и применение автоматических миграций.
* Ссылки для внешнего доступа к стилям, вебкартам (TMS), векторным слоям (MVT).
* Экспериментальный клиент WFS client и растровые мозаики, по умолчанию отключены.
* Поддержка WFS версии 1.1.0.
* Улучшена обработка значений NODATA в растровых слоях и стилях.
* Компрессия PNG установлена в значение 3, так быстрее.
* Улучшение производительности тайлового кэша.
* Новый формат экспорта "CSV для Microsoft Excel" для лучшей совместимостью с Excel.
* Исправление бесконечного ожидания базы данных, включая ожидание во время удаления векторного слоя.
* Улучшена обработка некорректного тела ответа JSON получаемого от REST API, возвращается корректное сообщение об ошибке.
* Экспорт векторного слоя в формат MapInfo MIF/MID.
* Экспорт векторного слоя в формат Panorama SXF.

**Релиз 3.6.0**

* Улучшения и исправления поддержки протокола WFS.
* Изменение модели прав: теперь любое действие с ресурсом требует наличие права чтения этого ресурса и его родителей.
* Вычисление охвата слоя PostGIS и улучшения вычисления охвата векторного слоя.
* Экспорт векторного слоя в формат GeoPackage.
* Ускорение обработки пустых тайлов и изображений.
* Тайловый кэш и аннотации вебкарты теперь включены по умолчанию.
* Команда удаления брошенных таблиц векторных слоёв.
* Вспомогательное HTTP API с разъяснением прав ресурса.
* Поддержка like, geom и extensions в REST API векторного слоя.
* Поддержка ZIP-архивированных файлов GeoJSON и ускорение распаковки архивов ZIP.
* Кликабельные ссылки на ресурсы в вебкартах, сервисах WMS и WFS.
* Возможность отключить проверку SSL сертификата для соединения TMS.
* Компонент Lookup table теперь часть пакета ядра nextgisweb.
* Исправление тайлов TMS слоя в случае когда охват выходит за границы.
* Исправление совместимости с GDAL > 3, включая ориентацию осей.
* Ресурс библиотека маркеров SVG доступен для рендереров.

**Релиз 3.5.0**

* Экспорт растрового слоя в GeoTIFF, ERDAS IMAGINE и Panorama RMF.
* Настраиваемые предпросмотр для ресурсов.
* Улучшение окна выбора ресурсов: недоподходящие ресурсы теперь заблокированы для выбора.
* Новая реализация сервера WFS, исправлено много ошибок.
* Поддержка Quad-key в подключениях и слоях TMS.
* Поддержка geom_format и srs REST API векторного слоя (запросы POST / PUT).
* Сессионная аутентификация OAuth с поддержкой обновления токена.
* Удаление пользователей и групп через REST API.
* Отслеживание временных меток последней активности пользователя.
* Настройка всплывающего окна идентификации через панель управления.
* Ускорение очистки файлового хранилища.
* Исправление пакетного удаления объектов через API при передаче пустого списка.
* Исправление ошибки CORS для запросов возвращающих ошибки.
* Исправление формата отображения координат во всплывающем окне идентификации на веб карте.
* Исправление искажения тайлов для растровых стилей.

**Релиз 3.4.2**

* Исправление создания слоя WMS.

**Релиз 3.4.1**

* Исправление скролла в окне редактирования атрибутов векторного слоя.

**Релиз 3.4.0**

* Новый tus загрузчик файлов. Проверка лимитов до загрузки файла.
* Серверный клиент TMS. Новые типы ресурсов: соединение TMS и слой TMS.
* Создание, удаление, перемещение полей для существующего векторного слоя.
* Улучшенная интеграция с Sentry.
* Управление порядком слоёв сервиса WMS.
* Stay on the same page after login.
* Error messages improvements on trying to: render non-existing layer, access non-existing attachment or write a geometry to a layer with a different geometry type.

**Релиз от 2020-06-30**

* Общее. Добавление/удаление полей таблицы атрибутов слоя.
* Общее. Изменение порядка полей таблицы атрибутов слоя.

**Релиз от 2020-06-24**

* Общее. Поддержка растровых пирамид для растров отрисованных с помощью QGIS стиля.

**Релиз от 2020-06-05**

* Общее. Новый загрузчик данных. Ограничения на размер обрабатываются сразу, до попытки загрузки.
* Общее. При входе на странице Веб ГИС, оставаться на этой странице.
* Общее. Внятное сообщение об ошибке при попытке перехода на несуществующее вложение.
* Общее. Внятное сообщение об ошибке при попытке рендеринга несуществующего слоя.
* Общее. Внятное сообщение об ошибке при попытке записи определенного типа геометрии в слой с другим типом.
* Общее. Улучшение загрузки растров большого размера.
* Whitelabel. Новый модуль для настройки логотипов, упоминаний компании и других компонентов корпоративного оформления.

**Релиз от 2020-04-16**

* Для разработчиков. Получение охвата отдельного объекта. Пример: 
https://demo.nextgis.ru/api/resource/6646/feature/1/extent
* Для разработчиков. Запрос данных с сортировкой. Поддерживается обратная сортировка и сортировка по двум и более полям (если значения одинаковые в первом, то использовать второе и т.д). Пример: 
https://demo.nextgis.ru/api/resource/6646/feature/?limit=10&order_by=NAME
* Общий административный интерфейс. Запрет на блокировку последнего (единственного) администратора в системе.

**Релиз от 2020-03-03**

* Сервисы. Исправление объявленной системы координат WMS для растровых слоёв входящих в сервис.
* Сервисы. Исправление конвертации RGBA растров в JPG при запросе WMS.

**Релиз от 2020-02-12**

* Базы данных. Хранение Z типов геометрий. PolygonZ и т.п.
* Для разработчиков. API может отдавать и принимать Z типы геометрий.

**Релиз от 2019-11-18**

* Базы данных. Поддержка полей типа numeric в слоях подключенных из внешней базы PostgreSQL/PostGIS
* Поиск. Улучшен адресный поиск (запросы в Nominatim)
* Для разработчиков. API Веб карты теперь предоставляет не только идентификаторы стилей, но и идентификаторы слоёв.

**Релиз от 2019-11-06**

* Печать. Увеличение рамкой при печати теперь более качественно вписывает выбранную область в выбранный формат листа

**Релиз от 2019-10-17**

* Системы координат. Импортировать теперь можно и из ESRI WKT (отличается от OGC WKT)
* Системы координат. В названиях СК теперь поддерживается кириллица
* Системы координат. Идентификация на веб-картах больше не падает, если не удается получить координаты клика.

**Релиз от 2019-08-12**

* Веб-карта. Добавлен поиск по целочисленным полям через встроенную таблицу объектов.
* Веб-карта. Улучшено приближение к точке через встроенную таблицу объектов.
* Веб-карта. При добавлении объекта в режиме редактирования встроенная таблица корректно обновляется с появлением новой записи.
* Сервисы. Исправлена объявленная система координат для WFS
* Сервер. Добавлены условия `in`, `notin` и `startswith` для фильтров векторных слоёв.
* Общее. Новая система сообщений об ошибках для пользователя.

**Релиз от 2019-07-08**

* Веб-карта. Редактирование: создание, удаление, изменение объектов на карте.

**Релиз от 2019-07-01**

* Общий административный интерфейс. Экспорт данных векторного слоя в форматы Mapinfo, DXF, ESRI Shape. 
* Общий административный интерфейс. Установка кодировки и архивирование при экспорте.
* Веб-карта. Исправление базовых карт (подложек) в системах координат отличных от 3857.

**Релиз от 2019-06-27**

* Общий административный интерфейс. Настройка формата вывода градусов при идентификации на веб-карте.

**Релиз от 2019-06-17**

* Общий административный интерфейс. Улучшение системы прав. Скрытие пунктов меню которые нельзя применить пользователю с текущими правами.

**Релиз от 2019-05-27**

* Общий административный интерфейс. Управление логотипом организации через панель управления.

**Релиз от 2019-05-16**

* Общий административный интерфейс. Улучшение системы прав. Скрытие папок ресурсов от пользователей не имеющих к ним доступа.

**Релиз от 2019-04-05**

* Общий административный интерфейс. Улучшение механизма добавления слоёв PostGIS из подключенной внешней базы. Автодополнение имен таблиц, схем и т.д.

**Релиз от 2019-03-25**

* Веб-карта. Закладки теперь автоматически сортируются по полю-атрибуту.

**Релиз от 2019-01-15**

* Сервер. Поиск ресурсов (API).

